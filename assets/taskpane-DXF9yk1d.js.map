{"version":3,"mappings":"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","names":["showToast"],"ignoreList":[],"sources":["../../src/core/config.js","../../src/core/utils.js","../../src/core/eventBus.js","../../src/core/diagnostics.js","../../src/core/excelApi.js","../../src/core/columnMapper.js","../../src/UI/toast.js","../../src/UI/mainUI.js","../../src/index.js"],"sourcesContent":["// core/config.js\r\nexport const EXWZ_VERSION = \"13.0.0\";\r\n\r\nexport const DEFAULT_API_BASE = \"https://excelwizpro-backend.onrender.com\";\r\n\r\n// Column map cache TTL (enterprise-friendly)\r\nexport const COLUMN_MAP_TTL_MS = 90 * 1000; // 90s\r\nexport const MAX_DATA_ROWS_PER_COLUMN = 50000;\r\n\r\n// Backend / network\r\nexport const DEFAULT_REQUEST_TIMEOUT = 20000;\r\nexport const MAX_BACKEND_RETRIES = 3;\r\n","// core/utils.js\r\nexport function delay(ms) {\r\n  return new Promise((resolve) => setTimeout(resolve, ms));\r\n}\r\n\r\nexport function getEl(id) {\r\n  const el = document.getElementById(id);\r\n  if (!el) throw new Error(`Missing element: #${id}`);\r\n  return el;\r\n}\r\n\r\nexport function columnIndexToLetter(index) {\r\n  let n = index + 1;\r\n  let letters = \"\";\r\n  while (n > 0) {\r\n    const rem = (n - 1) % 26;\r\n    letters = String.fromCharCode(65 + rem) + letters;\r\n    n = Math.floor((n - 1) / 26);\r\n  }\r\n  return letters;\r\n}\r\n\r\nexport function normalizeName(name) {\r\n  return String(name || \"\")\r\n    .trim()\r\n    .toLowerCase()\r\n    .replace(/\\s+/g, \"_\");\r\n}\r\n\r\nexport function parseQueryParams() {\r\n  try {\r\n    return Object.fromEntries(new URLSearchParams(window.location.search));\r\n  } catch {\r\n    return {};\r\n  }\r\n}\r\n","// core/eventBus.js\r\nconst listeners = new Map();\r\n\r\nexport function on(event, handler) {\r\n  if (!listeners.has(event)) listeners.set(event, new Set());\r\n  listeners.get(event).add(handler);\r\n  return () => off(event, handler);\r\n}\r\n\r\nexport function off(event, handler) {\r\n  const set = listeners.get(event);\r\n  if (!set) return;\r\n  set.delete(handler);\r\n}\r\n\r\nexport function emit(event, payload) {\r\n  const set = listeners.get(event);\r\n  if (!set) return;\r\n  for (const handler of set) {\r\n    try {\r\n      handler(payload);\r\n    } catch (err) {\r\n      console.warn(`EventBus handler for '${event}' failed:`, err);\r\n    }\r\n  }\r\n}\r\n","// core/diagnostics.js\r\nexport function getOfficeDiagnostics() {\r\n  try {\r\n    return {\r\n      host: Office.context?.host || \"unknown\",\r\n      platform: Office.context?.diagnostics?.platform || \"unknown\",\r\n      version: Office.context?.diagnostics?.version || \"unknown\",\r\n      build: Office.context?.diagnostics?.build || \"n/a\"\r\n    };\r\n  } catch {\r\n    return { host: \"unknown\", platform: \"unknown\", version: \"unknown\" };\r\n  }\r\n}\r\n","// core/excelApi.js\r\nimport { delay } from \"./utils.js\";\r\nimport { emit } from \"./eventBus.js\";\r\nimport { getOfficeDiagnostics } from \"./diagnostics.js\";\r\n\r\nexport function officeReady() {\r\n  return new Promise((resolve) => {\r\n    if (window.Office && Office.onReady) {\r\n      Office.onReady(resolve);\r\n    } else {\r\n      let tries = 0;\r\n      const timer = setInterval(() => {\r\n        tries++;\r\n        if (window.Office && Office.onReady) {\r\n          clearInterval(timer);\r\n          Office.onReady(resolve);\r\n        }\r\n        if (tries > 40) {\r\n          clearInterval(timer);\r\n          resolve({ host: \"unknown\" });\r\n        }\r\n      }, 500);\r\n    }\r\n  });\r\n}\r\n\r\nexport async function ensureExcelHost(info) {\r\n  if (!info || info.host !== Office.HostType.Excel) {\r\n    console.warn(\"‚ö†Ô∏è Not Excel host:\", info && info.host);\r\n    emit(\"ui:toast\", { message: \"‚ö†Ô∏è Excel host not detected.\", kind: \"warn\" });\r\n    return false;\r\n  }\r\n  console.log(\"üü¢ Excel host OK\");\r\n  return true;\r\n}\r\n\r\nexport async function waitForExcelApi(maxAttempts = 20) {\r\n  for (let i = 1; i <= maxAttempts; i++) {\r\n    try {\r\n      await Excel.run(async (ctx) => {\r\n        ctx.workbook.properties.load(\"title\");\r\n        await ctx.sync();\r\n      });\r\n      return true;\r\n    } catch {\r\n      await delay(350 + i * 120);\r\n    }\r\n  }\r\n  emit(\"ui:toast\", {\r\n    message: \"‚ö†Ô∏è Excel not ready ‚Äî try reopening the add-in.\",\r\n    kind: \"warn\"\r\n  });\r\n  return false;\r\n}\r\n\r\nexport async function safeExcelRun(cb) {\r\n  try {\r\n    return await Excel.run(cb);\r\n  } catch (err) {\r\n    console.warn(\"Excel.run failed:\", err);\r\n    emit(\"ui:toast\", { message: \"‚ö†Ô∏è Excel not ready\", kind: \"error\" });\r\n    throw err;\r\n  }\r\n}\r\n\r\nexport async function refreshSheetDropdown(el) {\r\n  return safeExcelRun(async (ctx) => {\r\n    const sheets = ctx.workbook.worksheets;\r\n    sheets.load(\"items/name\");\r\n    await ctx.sync();\r\n\r\n    el.innerHTML = \"\";\r\n    sheets.items.forEach((s) => {\r\n      const opt = document.createElement(\"option\");\r\n      opt.value = s.name;\r\n      opt.textContent = s.name;\r\n      el.appendChild(opt);\r\n    });\r\n  });\r\n}\r\n\r\n// Workbook structure change awareness (best-effort)\r\nexport async function attachWorkbookChangeListeners() {\r\n  try {\r\n    await Excel.run(async (ctx) => {\r\n      const sheets = ctx.workbook.worksheets;\r\n      sheets.load(\"items/name\");\r\n      await ctx.sync();\r\n\r\n      sheets.items.forEach((sheet) => {\r\n        try {\r\n          const onChanged = sheet.onChanged;\r\n          if (onChanged && onChanged.add) {\r\n            onChanged.add(async () => {\r\n              emit(\"workbook:changed\");\r\n            });\r\n          }\r\n        } catch (err) {\r\n          console.warn(\"Sheet change listener unsupported:\", err);\r\n        }\r\n      });\r\n    });\r\n  } catch (err) {\r\n    console.warn(\"Workbook change listeners failed:\", err);\r\n  }\r\n}\r\n\r\nexport function getExcelVersion() {\r\n  const diag = getOfficeDiagnostics();\r\n  return diag.version || \"unknown\";\r\n}\r\n","// src/core/columnMapper.js\r\nimport {\r\n  COLUMN_MAP_TTL_MS,\r\n  MAX_DATA_ROWS_PER_COLUMN\r\n} from \"./config.js\";\r\nimport { columnIndexToLetter, normalizeName } from \"./utils.js\";\r\nimport { safeExcelRun } from \"./excelApi.js\";\r\nimport { emit, on } from \"./eventBus.js\";\r\n\r\nlet columnMapCache = \"\";\r\nlet lastColumnMapBuild = 0;\r\nlet refreshInProgress = false;\r\n\r\n/**\r\n * Build the Smart Column Map (V15.4)\r\n * ---------------------------------\r\n * Forced assumptions:\r\n *  - Exactly 1 header row\r\n *  - Data ALWAYS starts at row 2\r\n *  - This fixes all misalignment issues\r\n */\r\nasync function buildColumnMapInternal() {\r\n  return safeExcelRun(async (ctx) => {\r\n    const wb = ctx.workbook;\r\n    const sheets = wb.worksheets;\r\n\r\n    sheets.load(\"items/name,items/visibility\");\r\n    await ctx.sync();\r\n\r\n    const lines = [];\r\n    const globalNameCounts = Object.create(null);\r\n\r\n    for (const sheet of sheets.items) {\r\n      const vis = sheet.visibility;\r\n      const visText = vis !== \"Visible\" ? ` (${vis.toLowerCase()})` : \"\";\r\n      lines.push(`Sheet: ${sheet.name}${visText}`);\r\n\r\n      const used = sheet.getUsedRangeOrNullObject();\r\n      used.load(\"rowCount,columnCount,rowIndex,columnIndex,isNullObject\");\r\n      await ctx.sync();\r\n\r\n      if (used.isNullObject || used.rowCount < 1) continue;\r\n\r\n      // ---------------------------------------------------------\r\n      // FORCE: Exactly 1 header row\r\n      // ---------------------------------------------------------\r\n      const headerRows = 1;\r\n\r\n      const headerRange = sheet.getRangeByIndexes(\r\n        used.rowIndex,         // top row\r\n        used.columnIndex,\r\n        1,                     // ALWAYS 1 header row\r\n        used.columnCount\r\n      );\r\n      headerRange.load(\"values\");\r\n\r\n      const tables = sheet.tables;\r\n      tables.load(\"items/name\");\r\n\r\n      const pivots = sheet.pivotTables;\r\n      pivots.load(\"items/name\");\r\n\r\n      await ctx.sync();\r\n\r\n      const headers = headerRange.values;\r\n\r\n      // ---------------------------------------------------------\r\n      // FORCE: Data ALWAYS starts row 2\r\n      // ---------------------------------------------------------\r\n      const startRow = 2; // 1-based index\r\n\r\n      const lastRowCandidate = used.rowIndex + used.rowCount; // 1-based\r\n      const maxAllowed = startRow + MAX_DATA_ROWS_PER_COLUMN;\r\n      const lastRow = Math.min(lastRowCandidate, maxAllowed);\r\n\r\n      // ---------------------------------------------------------\r\n      // Column mapping (Sheet fields)\r\n      // ---------------------------------------------------------\r\n      if (lastRow >= startRow) {\r\n        for (let col = 0; col < used.columnCount; col++) {\r\n          const primaryHeader = String(headers[0][col] ?? \"\").trim();\r\n          if (!primaryHeader) continue;\r\n\r\n          let normalized = normalizeName(primaryHeader);\r\n\r\n          if (globalNameCounts[normalized]) {\r\n            globalNameCounts[normalized] += 1;\r\n            normalized = `${normalized}__${globalNameCounts[normalized]}`;\r\n          } else {\r\n            globalNameCounts[normalized] = 1;\r\n          }\r\n\r\n          const colLetter = columnIndexToLetter(used.columnIndex + col);\r\n          const safeSheet = sheet.name.replace(/'/g, \"''\");\r\n\r\n          lines.push(\r\n            `${normalized} = '${safeSheet}'!${colLetter}${startRow}:${colLetter}${lastRow}`\r\n          );\r\n        }\r\n      }\r\n\r\n      // ---------------------------------------------------------\r\n      // Tables\r\n      // ---------------------------------------------------------\r\n      const tableMeta = tables.items.map((table) => {\r\n        return {\r\n          table,\r\n          header: table.getHeaderRowRange(),\r\n          body: table.getDataBodyRange()\r\n        };\r\n      });\r\n\r\n      tableMeta.forEach((m) => {\r\n        m.header.load(\"values\");\r\n        m.body.load(\"address,rowCount,columnCount\");\r\n      });\r\n      await ctx.sync();\r\n\r\n      for (const { table, header } of tableMeta) {\r\n        lines.push(`Table: ${table.name}`);\r\n\r\n        const headerVals = header.values?.[0] || [];\r\n        headerVals.forEach((h) => {\r\n          if (!h) return;\r\n\r\n          let norm = normalizeName(`${table.name}.${h}`);\r\n          if (globalNameCounts[norm]) {\r\n            globalNameCounts[norm] += 1;\r\n            norm = `${norm}__${globalNameCounts[norm]}`;\r\n          } else {\r\n            globalNameCounts[norm] = 1;\r\n          }\r\n\r\n          const structured = `${table.name}[${h}]`;\r\n          lines.push(`${norm} = ${structured}`);\r\n        });\r\n      }\r\n\r\n      // ---------------------------------------------------------\r\n      // Pivot markers\r\n      // ---------------------------------------------------------\r\n      pivots.items.forEach((p) => lines.push(`PivotSource: ${p.name}`));\r\n    }\r\n\r\n    // ---------------------------------------------------------\r\n    // Named ranges\r\n    // ---------------------------------------------------------\r\n    const names = wb.names;\r\n    names.load(\"items/name\");\r\n    await ctx.sync();\r\n\r\n    const namedMeta = [];\r\n    for (const n of names.items) {\r\n      const r = n.getRange();\r\n      r.load(\"address\");\r\n      namedMeta.push({ name: n.name, range: r });\r\n    }\r\n    await ctx.sync();\r\n\r\n    namedMeta.forEach(({ name, range }) => {\r\n      lines.push(`NamedRange: ${name}`);\r\n\r\n      let norm = normalizeName(name);\r\n      if (globalNameCounts[norm]) {\r\n        globalNameCounts[norm] += 1;\r\n        norm = `${norm}__${globalNameCounts[norm]}`;\r\n      } else {\r\n        globalNameCounts[norm] = 1;\r\n      }\r\n\r\n      lines.push(`${norm} = ${range.address}`);\r\n    });\r\n\r\n    const preview = lines.join(\"\\n\").slice(0, 600);\r\n    console.log(\"üîç Column map preview (v15.4 forced row2):\\n\", preview);\r\n\r\n    return lines.join(\"\\n\");\r\n  });\r\n}\r\n\r\n// ---------------------------------------------------------\r\n// Auto-refresh caching\r\n// ---------------------------------------------------------\r\nexport async function autoRefreshColumnMap(force = false) {\r\n  if (refreshInProgress) return;\r\n  try {\r\n    const now = Date.now();\r\n    if (!force && columnMapCache && now - lastColumnMapBuild < COLUMN_MAP_TTL_MS) {\r\n      console.log(\"üîÑ Using cached Smart Column Map (recent)\");\r\n      return;\r\n    }\r\n\r\n    refreshInProgress = true;\r\n    console.log(\"üîÑ Refreshing Smart Column Map (v15.4)...\");\r\n    columnMapCache = await buildColumnMapInternal();\r\n    lastColumnMapBuild = Date.now();\r\n    console.log(\"‚úÖ Updated Smart Column Map (v15.4)\");\r\n    emit(\"columnMap:updated\", { columnMap: columnMapCache });\r\n\r\n  } catch (err) {\r\n    console.warn(\"Auto-refresh failed:\", err);\r\n    emit(\"ui:toast\", { message: \"‚ö†Ô∏è Could not refresh column map\", kind: \"error\" });\r\n  } finally {\r\n    refreshInProgress = false;\r\n  }\r\n}\r\n\r\nexport function getCurrentColumnMap() {\r\n  return columnMapCache;\r\n}\r\n\r\n// Invalidate cache on workbook change\r\non(\"workbook:changed\", () => {\r\n  columnMapCache = \"\";\r\n  lastColumnMapBuild = 0;\r\n  console.log(\"üßπ Column map cache invalidated due to workbook change\");\r\n});\r\n","// UI/toast.js\r\n\r\nlet container = null;\r\n\r\nfunction getContainer() {\r\n  if (!container) {\r\n    container = document.createElement(\"div\");\r\n    container.className = \"exwz-toast-container\";\r\n    Object.assign(container.style, {\r\n      position: \"fixed\",\r\n      bottom: \"14px\",\r\n      right: \"14px\",\r\n      zIndex: 99999,\r\n      display: \"flex\",\r\n      flexDirection: \"column\",\r\n      gap: \"6px\",\r\n      maxWidth: \"260px\",\r\n      pointerEvents: \"none\"\r\n    });\r\n    document.body.appendChild(container);\r\n  }\r\n  return container;\r\n}\r\n\r\nexport function showToast(msg, kind = \"info\") {\r\n  const c = getContainer();\r\n  const t = document.createElement(\"div\");\r\n\r\n  t.textContent = msg;\r\n  t.className = \"exwz-toast\";\r\n\r\n  const base = {\r\n    padding: \"8px 10px\",\r\n    borderRadius: \"6px\",\r\n    fontSize: \"0.85rem\",\r\n    fontFamily: \"Inter, sans-serif\",\r\n    boxShadow: \"0 2px 10px rgba(0,0,0,0.25)\",\r\n    pointerEvents: \"auto\"\r\n  };\r\n\r\n  const style = {\r\n    info: { background: \"#e5f1ff\", color: \"#084f94\" },\r\n    success: { background: \"#e6ffed\", color: \"#0c7a0c\" },\r\n    warn: { background: \"#fff4ce\", color: \"#976f00\" },\r\n    error: { background: \"#fde7e9\", color: \"#c22\" }\r\n  };\r\n\r\n  Object.assign(t.style, base, style[kind] || style.info);\r\n\r\n  c.appendChild(t);\r\n  setTimeout(() => t.remove(), 2400);\r\n}\r\n","/* global Excel */\r\nimport {\r\n  autoRefreshColumnMap,\r\n  getCurrentColumnMap\r\n} from \"../core/columnMapper.js\";\r\n\r\nimport { getExcelVersion, safeExcelRun } from \"../core/excelApi.js\";\r\nimport { DEFAULT_API_BASE } from \"../core/config.js\";\r\nimport { showToast } from \"./toast.js\";\r\nimport { emit, on } from \"../core/eventBus.js\";\r\n\r\nlet lastFormula = \"\";\r\n\r\n// ---------------------------------------------------------\r\n// Resolve Backend URL\r\n// ---------------------------------------------------------\r\nfunction resolveApiBase() {\r\n  try {\r\n    const params = new URLSearchParams(window.location.search);\r\n    if (params.get(\"apiBase\")) return params.get(\"apiBase\");\r\n\r\n    if (Office?.context?.roamingSettings) {\r\n      const saved = Office.context.roamingSettings.get(\"excelwizpro_api_base\");\r\n      if (saved) return saved;\r\n    }\r\n  } catch (err) {\r\n    console.warn(\"API base resolution error:\", err);\r\n  }\r\n  return DEFAULT_API_BASE;\r\n}\r\n\r\n// ---------------------------------------------------------\r\n// Initialize UI\r\n// ---------------------------------------------------------\r\nexport async function initUI() {\r\n  const sheetSelect = document.getElementById(\"sheetSelect\");\r\n  const queryBox = document.getElementById(\"query\");\r\n  const outputBox = document.getElementById(\"output\");\r\n  const generateBtn = document.getElementById(\"generateBtn\");\r\n  const clearBtn = document.getElementById(\"clearBtn\");\r\n  const insertBtn = document.getElementById(\"insertBtn\");\r\n\r\n  if (!sheetSelect || !queryBox || !outputBox) {\r\n    console.error(\"‚ùå UI elements missing\");\r\n    return;\r\n  }\r\n\r\n  // Populate sheet dropdown\r\n  await safeExcelRun(async (ctx) => {\r\n    const sheets = ctx.workbook.worksheets;\r\n    sheets.load(\"items/name\");\r\n    await ctx.sync();\r\n\r\n    sheetSelect.innerHTML = \"\";\r\n    sheets.items.forEach((s) => {\r\n      const opt = document.createElement(\"option\");\r\n      opt.value = s.name;\r\n      opt.textContent = s.name;\r\n      sheetSelect.appendChild(opt);\r\n    });\r\n  });\r\n\r\n  // Build column map on load\r\n  await autoRefreshColumnMap(true);\r\n\r\n  // Toast listener\r\n  on(\"ui:toast\", ({ message, kind }) => showToast(message, kind));\r\n\r\n  // Ping backend\r\n  pingBackend(resolveApiBase());\r\n\r\n  // ---------------------------------------------------------\r\n  // GENERATE FORMULA\r\n  // ---------------------------------------------------------\r\n  generateBtn.addEventListener(\"click\", async () => {\r\n    const prompt = queryBox.value.trim();\r\n    if (!prompt) {\r\n      showToast(\"‚ö†Ô∏è Enter a request\", \"warn\");\r\n      return;\r\n    }\r\n\r\n    if (!navigator.onLine) {\r\n      showToast(\"üì¥ Offline\", \"warn\");\r\n      return;\r\n    }\r\n\r\n    generateBtn.disabled = true;\r\n    outputBox.textContent = \"‚è≥ Generating‚Ä¶\";\r\n\r\n    try {\r\n      await autoRefreshColumnMap(false);\r\n\r\n      let columnMap = getCurrentColumnMap();\r\n      if (!columnMap) {\r\n        await autoRefreshColumnMap(true);\r\n        columnMap = getCurrentColumnMap();\r\n      }\r\n\r\n      const excelVersion = getExcelVersion();\r\n      const payload = {\r\n        query: prompt,\r\n        columnMap,\r\n        excelVersion,\r\n        mainSheet: sheetSelect.value\r\n      };\r\n\r\n      const apiBase = resolveApiBase();\r\n\r\n      const res = await fetch(`${apiBase}/generate`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(payload)\r\n      });\r\n\r\n      const data = await res.json();\r\n      lastFormula = data.formula || '=ERROR(\"No formula returned\")';\r\n      outputBox.textContent = lastFormula;\r\n      showToast(\"‚úÖ Formula ready\", \"success\");\r\n\r\n    } catch (err) {\r\n      console.error(\"Generation error:\", err);\r\n      outputBox.textContent = \"‚ùå Error ‚Äî check console\";\r\n      showToast(\"‚ö†Ô∏è Formula generation failed\", \"error\");\r\n    } finally {\r\n      generateBtn.disabled = false;\r\n    }\r\n  });\r\n\r\n  // ---------------------------------------------------------\r\n  // CLEAR BUTTON\r\n  // ---------------------------------------------------------\r\n  clearBtn.addEventListener(\"click\", () => {\r\n    outputBox.textContent = \"\";\r\n    queryBox.value = \"\";\r\n  });\r\n\r\n  // ---------------------------------------------------------\r\n  // INSERT FORMULA (EXCEL WEB SAFE)\r\n  // ---------------------------------------------------------\r\n  insertBtn.addEventListener(\"click\", async () => {\r\n    if (!lastFormula) {\r\n      showToast(\"‚ö†Ô∏è Nothing to insert\", \"warn\");\r\n      return;\r\n    }\r\n\r\n    // --------------------------------------------\r\n    // üî• REQUIRED FULL SANITIZATION FOR EXCEL WEB\r\n    // --------------------------------------------\r\n    let formula = lastFormula\r\n      .replace(/[\\u200B\\u200C\\u200D\\u200E\\u200F\\uFEFF\\u00A0]/g, \"\") // hidden Unicode\r\n      .replace(/[\\r\\n]+/g, \" \")                                   // remove newlines\r\n      .replace(/\\s+/g, \" \")                                      // collapse spaces\r\n      .replace(/''/g, \"'\")                                       // fix escaped quotes\r\n      .trim();\r\n\r\n    if (!formula.startsWith(\"=\")) {\r\n      formula = \"=\" + formula;\r\n    }\r\n\r\n    try {\r\n      await Excel.run(async (ctx) => {\r\n        const rng = ctx.workbook.getSelectedRange();\r\n        rng.load(\"rowCount,columnCount\");\r\n        await ctx.sync();\r\n\r\n        if (rng.rowCount !== 1 || rng.columnCount !== 1) {\r\n          const e = new Error(\"MULTI_CELL\");\r\n          e.code = \"MULTI_CELL\";\r\n          throw e;\r\n        }\r\n\r\n        // ---------------------------------------------------\r\n        // EXCEL WEB: MUST USE .formulas (NOT values/local)\r\n        // ---------------------------------------------------\r\n        rng.formulas = [[formula]];\r\n        await ctx.sync();\r\n      });\r\n\r\n      showToast(\"‚úÖ Inserted\", \"success\");\r\n    } catch (err) {\r\n      console.error(\"Insert error:\", err);\r\n      if (err?.code === \"MULTI_CELL\") {\r\n        showToast(\"‚ö†Ô∏è Select a single cell\", \"warn\");\r\n      } else {\r\n        showToast(\"‚ö†Ô∏è Could not insert formula\", \"error\");\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n// ---------------------------------------------------------\r\n// Backend health check\r\n// ---------------------------------------------------------\r\nasync function pingBackend(apiBase) {\r\n  try {\r\n    const res = await fetch(`${apiBase}/health`, { method: \"GET\" });\r\n    if (res.ok) emit(\"backend:ready\");\r\n    else emit(\"backend:error\");\r\n  } catch {\r\n    emit(\"backend:error\");\r\n  }\r\n}\r\n","// index.js\r\n/* global Office, Excel */\r\nimport \"../taskpane.css\";\r\nimport { EXWZ_VERSION } from \"./core/config.js\";\r\nimport {\r\n  officeReady,\r\n  ensureExcelHost,\r\n  waitForExcelApi,\r\n  attachWorkbookChangeListeners\r\n} from \"./core/excelApi.js\";\r\nimport { initUI } from \"./UI/mainUI.js\";\r\n\r\nconsole.log(`üß† ExcelWizPro Taskpane v${EXWZ_VERSION} starting‚Ä¶`);\r\n\r\nif (typeof Office !== \"undefined\" && Office && Office.config) {\r\n  Office.config = { extendedErrorLogging: true };\r\n}\r\n\r\n// -------------------------------------------------------------\r\n// FIX: Ensure Office + DOM are both ready before attaching UI\r\n// -------------------------------------------------------------\r\nasync function fullyReady() {\r\n  // Wait for Office runtime\r\n  const info = await officeReady();\r\n  if (!(await ensureExcelHost(info))) return false;\r\n  if (!(await waitForExcelApi())) return false;\r\n\r\n  // Wait for DOM\r\n  await new Promise((resolve) => {\r\n    if (document.readyState === \"complete\" || document.readyState === \"interactive\") {\r\n      resolve();\r\n    } else {\r\n      document.addEventListener(\"DOMContentLoaded\", resolve);\r\n    }\r\n  });\r\n\r\n  return true;\r\n}\r\n\r\n(async function boot() {\r\n  console.log(\"üß† Boot sequence‚Ä¶\");\r\n\r\n  if (!(await fullyReady())) {\r\n    console.warn(\"Office not ready.\");\r\n    return;\r\n  }\r\n\r\n  // Attach workbook listeners AFTER Excel is valid\r\n  await attachWorkbookChangeListeners();\r\n\r\n  // Attach UI handlers AFTER DOM is fully loaded\r\n  await initUI();\r\n\r\n  const { showToast } = await import(\"./UI/toast.js\");\r\n  showToast(\"‚úÖ ExcelWizPro ready!\", \"success\");\r\n})();\r\n"],"file":"assets/taskpane-DXF9yk1d.js"}